<ng-container *ngIf="{
                resultsAreLoading: resultsAreLoading$ | async,
                filter: filter$ | async,
                currentLanguage: currentLanguage$| async,
                results: results$ | async,
                totalCount: totalCount$ | async,
                currentUser: currentUser$ | async,
                jobSearchMailToLink: jobSearchMailToLink$ | async
              } as observablesResolved">

  <div #searchPanel
       class="container-fluid query-search-area pt-4 pt-lg-5 pb-4">
    <div class="form-row">
      <h2 class="sr-only">
        {{'portal.job-ad-search.browser-title' | translate}}
      </h2>
      <alv-job-query-panel class="col-lg-9"
                           (jobQueryPanelValuesChange)="onQueryChange($event)"
                           [showSpinner]="observablesResolved.resultsAreLoading"
                           [jobQueryPanelValues]="observablesResolved.filter">
      </alv-job-query-panel>

      <div class="col-lg-3 d-flex">
        <button class="reset-button btn btn-text mt-1 mt-lg-0 flex-grow-1 flex-lg-grow-0"
                (click)="onResetFilter()">
          {{ 'job-search.toolbar.reset' | translate }}
        </button>
      </div>
    </div>
  </div>
  <div (scrolled)="onScroll()"
       [fromRoot]="true"
       [infiniteScrollThrottle]="50"
       [immediateCheck]="true"
       class="container-fluid"
       infiniteScroll>

    <alv-three-column-layout [mobileOrdering]="[1, 3, 2]"
                             [stickyTop]="layoutConstants.STICKY_TOP_SEARCH + searchPanelHeight">
      <ng-container class="left-column">
        <div class="alv-bar mb-1">
          <span *ngIf="observablesResolved.resultsAreLoading; else resultsCount">...</span>
          <ng-template #resultsCount>
            <strong>{{observablesResolved.totalCount | number}} {{'portal.job-ad-search.results-count.label' | translate}}</strong>
          </ng-template>

        </div>
        <h2 class="sr-only">
          {{'job-search.filter.title' | translate}}
        </h2>
        <alv-filter-panel (filterPanelValueChange)="onFiltersChange($event)"
                          [filterPanelValues]="observablesResolved.filter">
        </alv-filter-panel>
      </ng-container>

      <ng-container class="main-column">
        <h2 class="sr-only">
          Stellen Suchresultate
        </h2>
        <ng-container *ngIf="observablesResolved.results as results">
          <alv-job-search-result *ngFor="let result of results; trackBy: trackById"
                                 [jobSearchResult]="result"
                                 [language]="observablesResolved.currentLanguage"
                                 [currentUser]="observablesResolved.currentUser"
                                 (addFavourite)="addFavourite($event)"
                                 (updatedFavourite)="updatedFavourite($event)"
                                 (removeFavourite)="removeFavourite($event)"
                                 routerLinkBase="/job-search">
          </alv-job-search-result>
          <div *ngIf="!results.length">
            {{'global.common-phrases.no-results-found' | translate}}
          </div>
        </ng-container>
      </ng-container>

      <ng-container class="right-column">
        <div class="w-100 mb-3 text-right text-md-left">
          <a *ngIf="observablesResolved.jobSearchMailToLink as jobSearchMailToLink"
             class="btn btn-text btn-text-icon btn-truncate"
             [href]="jobSearchMailToLink">
            <fa-icon class="mr-1"
                     [icon]="['fas', 'share']"></fa-icon>
            {{'portal.job-search.sendLink' | translate}}
          </a>
        </div>
      </ng-container>
    </alv-three-column-layout>
  </div>
</ng-container>
